---
name: Fix wrapper option conflicts - avoid shadowing wrapped CLI commands
status: open
created: 2025-08-25T13:05:00Z
updated: 
github: 
depends_on: []
parallel: false
conflicts_with: []
priority: critical
type: hotfix
---

# Task: Fix wrapper option conflicts - avoid shadowing wrapped CLI commands

## Description
**CRITICAL HOTFIX**: REPOCLI is a wrapper and must not shadow options/commands of the wrapped CLI tools (gh, glab, tea). Current implementation incorrectly intercepts `--help`, `--version`, and `init` commands that should be passed through to the underlying CLI tools.

## Problem Analysis
As a wrapper, REPOCLI should only intercept:
1. **Configuration options** (e.g., `--repocli-config`) - wrapper-specific
2. **Wrapper-specific commands** with clear namespacing

Current problematic intercepted options/commands:
- `--help` → Should pass through to `gh help`, `glab help`, etc.
- `--version` → Should pass through to `gh version`, `glab version`  
- `init` → Should pass through to `gh init`, `glab init` (repo initialization)

## Acceptance Criteria
- [ ] Remove `--help` interception - pass through to wrapped CLI
- [ ] Remove `--version` interception - pass through to wrapped CLI  
- [ ] Replace `init` command with `repocli:init` for configuration setup
- [ ] Replace `--version` with `--repocli-version` for wrapper version info
- [ ] Update all documentation to use new namespaced commands
- [ ] Ensure `gh help`, `glab help` work correctly through wrapper
- [ ] Ensure `gh version`, `glab version` work correctly through wrapper
- [ ] Add `--repocli-help` option for wrapper-specific help

## Implementation Changes

### 1. Main Script (`repocli`)
**Remove these intercepts:**
```bash
# Remove these lines - they shadow wrapped CLI
case "$1" in
    "--help") show_help; exit 0 ;;
    "--version") show_version; exit 0 ;;
    "init") handle_init "$@"; exit 0 ;;
esac
```

**Add wrapper-specific handling:**
```bash
# Only intercept wrapper-specific options
case "$1" in
    "--repocli-version") show_repocli_version; exit 0 ;;
    "--repocli-help") show_repocli_help; exit 0 ;;
    "--repocli-config") # existing implementation ;;
    "repocli:init") handle_repocli_init "$@"; exit 0 ;;
esac
```

### 2. Configuration System (`lib/config.sh`)
- Rename `init` command to `repocli:init`
- Update all references to use namespaced commands

### 3. Documentation Updates
**README.md:**
```bash
# OLD (problematic)
repocli --help
repocli --version
repocli init

# NEW (correct)  
repocli --repocli-help
repocli --repocli-version
repocli repocli:init
```

**Help text:**
- Remove generic `--help` from wrapper
- Add `--repocli-help` for wrapper-specific help
- Document that `gh help`, `glab help` work through wrapper

## Wrapper Principle Compliance

**✅ SHOULD intercept:**
- `--repocli-config` (configuration)
- `--repocli-version` (wrapper version)
- `--repocli-help` (wrapper help)
- `repocli:init` (wrapper setup)

**❌ MUST NOT intercept:**
- `--help` → Pass to `gh help`, `glab help`
- `--version` → Pass to `gh version`, `glab version`
- `init` → Pass to `gh init`, `glab init`
- Any other CLI-specific options/commands

## Dependencies
- [ ] Update existing configuration references
- [ ] Update test configurations that use `init`
- [ ] Update documentation across the project

## Effort Estimate
- Size: S-M (hotfix)
- Hours: 2-4 hours
- Priority: **CRITICAL** - blocks proper wrapper functionality
- Type: hotfix (must be applied immediately)

## Definition of Done
- [ ] All shadowing intercepts removed from main script
- [ ] Wrapper-specific commands properly namespaced
- [ ] `gh help`, `glab help` work through wrapper
- [ ] `gh version`, `glab version` work through wrapper  
- [ ] `repocli:init` replaces `init` for configuration
- [ ] `--repocli-version` replaces `--version` for wrapper info
- [ ] Documentation updated throughout project
- [ ] Manual testing confirms proper passthrough
- [ ] No CLI tool functionality is shadowed

## Testing Scenarios
```bash
# These should work (passthrough)
repocli --help           # → gh help or glab help
repocli --version        # → gh version or glab version  
repocli init my-repo     # → gh init my-repo or glab init

# These should work (wrapper-specific)
repocli --repocli-version    # → REPOCLI version info
repocli --repocli-help       # → REPOCLI wrapper help
repocli repocli:init         # → REPOCLI configuration setup
```

## Critical Impact
This hotfix is essential for REPOCLI to function correctly as a wrapper. Without this fix, users cannot access help or version information from the underlying CLI tools, breaking the fundamental wrapper contract.