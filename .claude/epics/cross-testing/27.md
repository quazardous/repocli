---
name: Implement CI/Test Runner Foundation
status: open
created: 2025-08-25T18:30:00Z
updated: 
github: https://github.com/quazardous/repocli/issues/27
depends_on: [14]
parallel: true
conflicts_with: []
---

# Task: Implement CI/Test Runner Foundation

## Description
Create the foundational CI and test runner infrastructure for the cross-testing framework. This task establishes the basic test execution framework that tasks #5, #6, and future provider tests will use for consistent test execution and reporting.

**üéØ PRIMARY FOCUS**: Establish test runner infrastructure and CI foundation before completing individual provider tests.

## Acceptance Criteria
- [ ] **Test Runner Scripts**: Create `run-github-tests.sh`, `run-gitlab-tests.sh`, `run-cross-tests.sh`
- [ ] **Basic Configuration Tests**: Run fundamental REPOCLI configuration validation tests
- [ ] **CI Integration**: Basic CI workflow structure for automated testing
- [ ] **Test Result Reporting**: Standardized output format and exit codes
- [ ] **Configuration Integration**: Uses task #14 test-config.sh API consistently
- [ ] **Error Handling**: Proper error reporting and cleanup
- [ ] **Documentation**: Usage instructions for test runners

## Technical Details
- **Implementation approach**: Create reusable test runner scripts that use task #14 API
- **Key considerations**: Consistent interface, proper cleanup, clear reporting
- **Code locations/files affected**:
  - `tests/cross-testing/run-github-tests.sh` (new)
  - `tests/cross-testing/run-gitlab-tests.sh` (new) 
  - `tests/cross-testing/run-cross-tests.sh` (enhance existing)
  - `.github/workflows/cross-testing.yml` (new CI workflow)

## Implementation Requirements

### Basic Configuration Tests
```bash
# tests/cross-testing/lib/config-tests.sh
# Basic REPOCLI configuration validation tests

test_basic_config_loading() {
    echo "üîß Testing basic configuration loading..."
    
    # Test 1: REPOCLI_CONFIG environment variable
    local temp_config=$(mktemp)
    echo "provider=github" > "$temp_config"
    REPOCLI_CONFIG="$temp_config" repocli --version >/dev/null 2>&1
    local exit_code=$?
    rm -f "$temp_config"
    
    if [[ $exit_code -eq 0 ]]; then
        echo "‚úÖ REPOCLI_CONFIG environment variable works"
    else
        echo "‚ùå REPOCLI_CONFIG environment variable failed"
        return 1
    fi
    
    # Test 2: Provider selection
    echo "‚úÖ Basic configuration loading tests passed"
    return 0
}
```

### Test Runner Scripts Structure
```bash
# tests/cross-testing/run-github-tests.sh
#!/bin/bash
# GitHub Provider Test Runner
# Uses task #14 test-config.sh API for consistent configuration

source "$(dirname "${BASH_SOURCE[0]}")/lib/test-config.sh"
source "$(dirname "${BASH_SOURCE[0]}")/lib/config-tests.sh"

main() {
    echo "üß™ GitHub Provider Test Runner"
    echo "=============================="
    
    # Run basic configuration tests first
    echo "üìã Running basic configuration tests..."
    test_basic_config_loading || exit 1
    
    # Validate environment
    validate_test_configuration
    
    # Run GitHub provider tests
    if run_test_with_provider "github" run_github_ping_tests; then
        echo "‚úÖ GitHub provider tests PASSED"
        exit 0
    else
        echo "‚ùå GitHub provider tests FAILED"
        exit 1
    fi
}

main "$@"
```

### CI Workflow Structure
```yaml
# .github/workflows/cross-testing.yml
name: Cross-Provider Testing

on:
  push:
    branches: [ main, epic/* ]
  pull_request:
    branches: [ main ]

jobs:
  github-tests:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v4
      - name: Install GitHub CLI
        run: sudo apt-get install gh
      - name: Run GitHub Provider Tests
        run: ./tests/cross-testing/run-github-tests.sh

  gitlab-tests:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v4
      - name: Install GitLab CLI
        run: |
          curl -fsSL https://gitlab.com/gitlab-org/cli/-/releases/permalink/latest/downloads/glab_linux_amd64.deb -o glab.deb
          sudo dpkg -i glab.deb
      - name: Run GitLab Provider Tests
        run: ./tests/cross-testing/run-gitlab-tests.sh
```

## Dependencies
- [x] Task #14: Test configuration utilities must be implemented
- [ ] Individual provider test implementations (tasks #5, #6)

## Definition of Done
- [ ] All test runner scripts created and working
- [ ] CI workflow configured and tested
- [ ] Test runners use task #14 API consistently
- [ ] Proper error handling and cleanup implemented
- [ ] Documentation updated with usage instructions